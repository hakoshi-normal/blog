---
title: 【入門1】Python仮想環境
# publishdate: 2023-12-01
date: 2025-05-06
tags: [Python, Conda, 仮想環境, YOLO入門]
toc: true
---

## ライブラリとは？

**ライブラリ**とは，再利用可能なソフトウェア部品のことで，特定の機能をまとめたコードの再集合のことを指します．簡単に言えば，他の人が作ってくれた機能を自身のプログラムで使える便利なコード集のことです．
Pythonには**標準ライブラリ**と**外部ライブラリ**の2種類があります．

### 標準ライブラリ

標準ライブラリはPythonをインストールしたときに標準的に入っているライブラリのことです．通常のプログラム作成時に頻繁に必要となる機能をまとめたものが多くあります．例えば，

- 乱数を作成する random
- 時刻を取得できる datetime, time
- ファイルシステムへのアクセスを実現する os, shutil
- 基礎的な数学関数 math
- HTMLサポート html
- URLを使ってインターネットにアクセスできる urllib

スマートフォンで言うところのカメラ，アルバム，時計などのデフォルトアプリみたいなものです．これらはPythonが動く環境であれば勝手に入っているため，```import ライブラリ名```と記述すればすぐに利用することができます．助かる！！

```python
# サイコロの出目を出力
import random
dice_roll = random.randint(1, 6)
print("サイコロの出目:", dice_roll)
```

### 外部ライブラリ

外部ライブラリはPythonにはもともと組み込まれておらず，自身で導入するタイプのライブラリのことです．実装したいプログラムの機能に応じて適切に選択する必要があります．例えば，

- 効率的な多次元配列の数値計算を実現する Numpy
- 画像処理の機能を提供する OpenCV
- グラフを簡単に描画できる Matplotlib
- 様々なアルゴリズムでの機械学習を可能とする scikit-learn
- Webアプリの開発に役立つ Django

スマートフォンで言うところのゲームやチャットアプリなどのストアアプリみたいなものです．これらは自身でインストール作業をする必要がありますが，それさえ済ませば高機能な実装をいとも容易く実現できます！とても便利！！
有志のプログラマが開発して公開してくれているため，感謝の気持ちを忘れずに使いましょう（Pythonもそうだけど）．

```python
# サイコロの出目を出力
import numpy as np
dice_roll = np.random.randint(1, 7)
print("サイコロの出目:", dice_roll)
```

## ライブラリを確認してみよう

では，ここからは実際に手を動かしながら解説を進めます．
まずはスタートメニューから **Anaconda Prompt** を開いてください．

{{< figure src="img_start.png" class="center">}}

{{< figure src="console_start.png" class="center">}}

これは**コマンドプロンプト**と呼ばれる画面で，ここに**コマンド**と呼ばれる命令文を入力することでコンピュータを操作できます．
試しに，ここに```tree```と打ち込んでEnterキーを押してみてください．

......何かツリー構造の記述がたくさん出てきたかと思います．これはディレクトリ構造をツリー形式で表示するコマンドです（あんまり使わないけど）！
なかなか表示が終わらない場合はCtrl+Cキーでキャンセルしてください．

ではコマンドを使って，今使っているPythonで利用可能な外部ライブラリの一覧を見てみましょう！
Anaconda Promptに```conda list```と打ち込んでEnterキーを押してみてください．

{{< figure src="modules.png" class="center">}}

インストール済みライブラリとバージョンの一覧が表示されました．既にたくさん入っているようです！

よくよく見てみると，数値計算ができるNumpyや表データを扱えるPandasなど，データサイエンスに役立つライブラリがたくさんあります．
実はAnacondaは科学計算のためのPython配布形式（ディストリビューション）の一つであり，既に役立つライブラリが揃えられているんです．

この状態，一見プログラムを書くのに便利な環境であるように見えるんですが実はそうでないケースがあります．

実はライブラリは，機能を実現するために別のライブラリを参照するケースがあります．例えば，

- 画像処理を実現するOpenCVには，画像を配列として扱うためにNumpyが必要
- グラフを描画するMatplotlibには，画像描画のためにPillowが必要
- 機械学習を実現するscikit-learnには，高度な数値計算をするためにScipyが必要

またライブラリはバージョンによって提供される機能が変化することがあります．そのため，同じ実行環境に特定のバージョンを指定して参照ライブラリを導入しておく必要があるのです．

これを，ライブラリの**依存関係**と言います．この依存関係が原因で複数のライブラリを導入するときに問題が発生する可能性があるんです．

例えば，ライブラリA-C及びB-Cの依存関係があるとき，AとBが共存するためにはCのバージョンが整合している必要があります．

こうしたライブラリバージョンの試行錯誤を行う場合，先程表示させた複雑に依存関係が絡み合ったライブラリ群を扱うのはなかなか骨が折れます．

また，不要なライブラリは更に混乱を引き起こすので必要となる機能のための**最小構成**で開発環境を整える必要があります．

そこで役立つのが，**仮想環境**です！！！（やっと本題）

## 仮想環境

**仮想環境**とは，プログラムを動かすときに仮に作って利用する動作環境のことです．
簡単に言うと「依存関係の解決が面倒だから，まっさらな世界を一から創造すればいいじゃん！！」です．

では，実際に作ってみましょう．

1. 先ほど開いたAnaconda Promptに```conda create -n test python=3.12```と打ち込んで実行（```Proceed([y]/n)?```には```y```を入力して処理を続行）
2. ```conda activate test```と打ち込んで実行

ここでは，testという名前の仮想環境を作成してその環境に切り替える，という作業をしてもらいました．
最新行の左側が```(test)```と表示されていれば成功です！

{{< figure src="test_env.png" class="center">}}

先ほどまでは```(base)```と表示されていたはずです．Anacondaではデフォルトでbase環境があり，そこにたくさんのライブラリがありました．
では```conda list```で現在の```test```環境のライブラリ構成を見てみましょう！

base環境と比べてライブラリの数がかなり少なくなったはずです．ここに表示されているライブラリはPython3.12に付随する必要最低限のライブラリです．
このきれいな環境に最小限の適切なライブラリを導入することで，快適なコーディングライフを送ることができます！！

## 番外編：Conda仮想環境の管理

複数の仮想環境を扱うときに便利なコマンドをまとめておきます！

仮想環境の作成（環境名がtest，Python3.12の場合）

```console
conda create -n test python=3.12
```

仮想環境への移行

```console
conda activate test
```

仮想環境から離脱

```console
conda deactivate
```

仮想環境の削除

```console
conda remove -n test --all
```

仮想環境一覧の表示

```console
conda info -e
```
